!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=n():e.riveted=n()}(this,function(){var n,t,i,o,a,r,u,c,d,l,f,v,s,m,e,p,g,y,w="Riveted",T="Time Spent",I="RivetedTiming",h="Riveted",_="First Interaction";function k(t,i){function o(){d=new Date,c=null,u=t.apply(a,r)}var a,r,u,c=null,d=0;return function(){var e=new Date,n=i-(e-(d=d||e));return a=this,r=arguments,n<=0?(clearTimeout(c),c=null,d=e,u=t.apply(a,r)):c=c||setTimeout(o,n),u}}function b(e,n,t){e.addEventListener?e.addEventListener(n,t,!1):e.attachEvent?e.attachEvent("on"+n,t):e["on"+n]=t}function D(){dataLayer.push(arguments)}function E(){clearTimeout(y),s=!0,clearInterval(g)}function H(){(document.hidden||document.webkitHidden)&&E()}function L(){0<(e+=1)&&e%i==0&&n(e)}function q(){var e;m||(v||(e=new Date,v=!0,t(e-p),g=setInterval(L,1e3)),s&&(s=!1,clearInterval(g),g=setInterval(L,1e3)),clearTimeout(y),y=setTimeout(E,1e3*o+100))}return m=s=v=!1,e=0,p=new Date,y=g=null,t=function(e){d?D("event",I,{event_category:h,event_label:f+"-"+_,value:e}):(r&&window[l](c,"timing",h,f+"-"+_,e),u&&_gaq.push(["_trackTiming",h,f+"-"+_,e,null,100]))},n=function(e){d?D("event",T,{event_category:w,event_label:f,value:i,non_interaction:a}):(r&&window[l](c,"event",w,T,f,i,{nonInteraction:a}),u&&_gaq.push(["_trackEvent",w,T,f,i,a]))},{init:function(e){e=e||{},i=parseInt(e.reportInterval,10)||5,o=parseInt(e.idleTimeout,10)||30,l=e.gaGlobal||"ga",f=e.domcontext||"document","function"==typeof window[l]&&(r=!0),"undefined"!=typeof _gaq&&"function"==typeof _gaq.push&&(u=!0),"undefined"!=typeof dataLayer&&"function"==typeof dataLayer.push&&(d=!0),c="gaTracker"in e&&"string"==typeof e.gaTracker?e.gaTracker+".send":"send","function"==typeof e.eventHandler&&(n=e.eventHandler),"function"==typeof e.userTimingHandler&&(t=e.userTimingHandler),a=!("nonInteraction"in e)||!1!==e.nonInteraction&&"false"!==e.nonInteraction,b(document,"keydown",q),b(document,"click",q),b(window,"mousemove",k(q,500)),b(window,"scroll",k(q,500)),b(document,"visibilitychange",H),b(document,"webkitvisibilitychange",H)},trigger:q,setIdle:E,on:function(){m=!1},off:function(){E(),m=!0},reset:function(){p=new Date,e=0,s=v=!1,clearInterval(g),clearTimeout(y)}}});
