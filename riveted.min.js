!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=n():e.riveted=n()}(this,function(){return function(){var e,n,t,i,o,a,r,u,c,d,l=!1,f=!1,v=!1,s=0,m=new Date,p=null,g=null;function y(e,n){var t,i,o,a=null,r=0,u=function(){r=new Date,a=null,o=e.apply(t,i)};return function(){var c=new Date;r||(r=c);var d=n-(c-r);return t=this,i=arguments,d<=0?(clearTimeout(a),a=null,r=c,o=e.apply(t,i)):a||(a=setTimeout(u,d)),o}}function w(e,n,t){e.addEventListener?e.addEventListener(n,t,!1):e.attachEvent?e.attachEvent("on"+n,t):e["on"+n]=t}function T(){dataLayer.push(arguments)}function I(){clearTimeout(g),f=!0,clearInterval(p)}function h(){(document.hidden||document.webkitHidden)&&I()}function _(){(s+=1)>0&&s%t==0&&e(s)}function k(){var e;v||(l||(e=new Date,l=!0,n(e-m),p=setInterval(_,1e3)),f&&(f=!1,clearInterval(p),p=setInterval(_,1e3)),clearTimeout(g),g=setTimeout(I,1e3*i+100))}return n=function(e){c?T("event","RivetedTiming",{event_category:"Riveted",event_label:"First Interaction",value:e}):(a&&window[d](u,"timing","Riveted","First Interaction",e),r&&_gaq.push(["_trackTiming","Riveted","First Interaction",e,null,100]))},e=function(e){c?T("event","Time Spent",{event_category:"Riveted",event_label:e,value:t,non_interaction:o}):(a&&window[d](u,"event","Riveted","Time Spent",e.toString(),t,{nonInteraction:o}),r&&_gaq.push(["_trackEvent","Riveted","Time Spent",e.toString(),t,o]))},{init:function(l){l=l||{},t=parseInt(l.reportInterval,10)||5,i=parseInt(l.idleTimeout,10)||30,d=l.gaGlobal||"ga","function"==typeof window[d]&&(a=!0),"undefined"!=typeof _gaq&&"function"==typeof _gaq.push&&(r=!0),"undefined"!=typeof dataLayer&&"function"==typeof dataLayer.push&&(c=!0),u="gaTracker"in l&&"string"==typeof l.gaTracker?l.gaTracker+".send":"send","function"==typeof l.eventHandler&&(e=l.eventHandler),"function"==typeof l.userTimingHandler&&(n=l.userTimingHandler),o=!("nonInteraction"in l)||!1!==l.nonInteraction&&"false"!==l.nonInteraction,w(document,"keydown",k),w(document,"click",k),w(window,"mousemove",y(k,500)),w(window,"scroll",y(k,500)),w(document,"visibilitychange",h),w(document,"webkitvisibilitychange",h)},trigger:k,setIdle:I,on:function(){v=!1},off:function(){I(),v=!0},reset:function(){m=new Date,s=0,l=!1,f=!1,clearInterval(p),clearTimeout(g)}}}()});
